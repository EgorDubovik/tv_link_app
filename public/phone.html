<html>
   <head>
      <title>Phone</title>
   </head>
   <body>
      <div id="sessionId"></div>
      <input type="text" id="message" />
      <button onclick="sendMessage()">Send</button>
   </body>

   <script>
      const path = window.location.pathname;  // "/phone/71715540-f756-448e-8342-bd7f6f5a9456"
      const segments = path.split('/');       // ["", "phone", "71715540-f756-448e-8342-bd7f6f5a9456"]
      const sessionId = segments[2];
      document.getElementById('sessionId').innerHTML = sessionId;
      fetch('/phone/ws/' + sessionId)
         .then(response => response.json())
         .then(data => {
            const ws = new WebSocket(data.wsLink);
            ws.onopen = () => {
               console.log('WebSocket Client Connected');
            };
            ws.onclose = () => {
               console.log('WebSocket Client Disconnected');
            };
            ws.onmessage = (message) => {
               console.log(message.data);
            };
         });

      function sendMessage() {
         const message = document.getElementById('message').value;
         fetch('/onmessage/', {
            method: 'POST',
            headers: {
               'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
               sessionId: sessionId,
               message: message
            }),
         })
            .then(response => response.json())
            .then(data => {
               console.log(data);
            });
      }
   </script>
</html>
